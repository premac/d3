<html>

<head>
    <!--<meta http-equiv="refresh" content="2">-->
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <style>
    .chart rect {
        fill: steelblue;
        stroke: white;
    }

    .chart text {
        font: 10px sans-serif;
        fill: white;
    }

    .chart text.rule {
        font: 10px sans-serif;
        fill: black;
    }

    </style>

</head>

<body>

<script type="text/javascript" language="javascript">

var t = 1297110663, // start time (seconds since epoch)
    v = 70, // start value (subscribers)
    data = d3.range(35).map(next); // starting dataset

function next() {
  return {
    time: ++t,
    value: v = 
    ~~Math.max(10, Math.min(90, v + 10 * (Math.random() - .5)))
  };
}

setInterval(function() {
  data.shift();
  data.push(next());
  data.push(next());
  redraw();
}, 1500);

var w = 20,
    h = 80;

var x = d3.scale.linear()
    .domain([0, 1])
    .range([0, w]);

var y = d3.scale.linear()
    .domain([0, 100])
    .rangeRound([0, h]);

var chart = d3.select("body").append("svg")
    .attr("class", "chart")
    .attr("width", w * data.length - 1)
    .attr("height", h);

chart.selectAll("rect")
    .data(data)
  .enter().append("rect")
    .attr("x", function(d, i) { return x(i) - .5; })
    .attr("y", function(d) { return h - y(d.value) - .5; })
    .attr("width", w)
    .attr("height", function(d) { return y(d.value); });

chart.append("line")
    .attr("x1", 0)
    .attr("x2", w * data.length)
    .attr("y1", h - .5)
    .attr("y2", h - .5)
    .style("stroke", "#000");

function redraw() {

chart.attr("width", w * data.length - 1)
  chart.selectAll("rect")
        .data(data)
    .enter().append("rect") ;

  // Updateâ€¦
  chart.selectAll("rect")
        .data(data)
    .transition()
        .duration(1000)
      .attr("y", function(d) { return h - y(d.value) - .5; })
      .attr("height", function(d) { return y(d.value); });

}

window.onload = redraw();


    //http://mbostock.github.io/d3/tutorial/bar-2.html
/*
    var data = {
        "2013-04-26T06:05:00.000Z":
        {
            "total_size":400,
                "average_response_time":16.666666666666668,
                "operation_count":12,
                "write_ratio":0.5,
                "hit_ratio":0.3333333333333333
        },
        "2013-04-26T06:05:00.000Z":
        {
            "total_size":"400",
                "average_response_time":16.666666666666668,
                "operation_count":12,
                "write_ratio":0.5,
                "hit_ratio":0.3333333333333333
        }
    }

    alert(Math.max.apply(Math, array.map(function(o)))
    Math.max.apply(Math,array.map(function(o){return o.y;}))

    )

    var w = 20,
        h = 300;

    var x = d3.scale.linear()
        .domain([0, 1])
        .range([0, w]);

    var y = d3.scale.linear()
        .domain([0, 100])
        .rangeRound([0, h]);

    var chart = d3.select("body").append("svg")
            .attr("class", "chart")
            .attr("width", "440")
            .attr("height", 140)
            .append("g")
            .attr("transform", "translate(10,15)");

    var x = d3.scale.linear()
            .domain([0, d3.max(data)])
            .range([420, 0]);

    var y = d3.scale.ordinal()
            .domain(data)
            .rangeBands([0, 120]);


    chart.selectAll("rect")
            .data(data)
            .enter().append("rect")
            .attr("y", y)
            .attr("width", x)
            .attr("height", y.rangeBand);

    chart.selectAll("text")
            .data(data)
            .enter()
            .append("text")
            .attr("x", x)
            .attr("y", function(d) { return y(d) + y.rangeBand() / 2; })
            .attr("dx", -3) // padding-right
            .attr("dy", ".35em") // vertical-align: middle
            .attr("text-anchor", "end") // text-align: right
            .text(String);

    chart.selectAll("line")
            .data(x.ticks(10))
            .enter().append("line")
            .attr("x1", x)
            .attr("x2", x)
            .attr("y1", 0)
            .attr("y2", 120)
            .style("stroke", "#ccc");

    chart.selectAll(".rule")
            .data(x.ticks(10))
            .enter().append("text")
            .attr("class", "rule")
            .attr("x", x)
            .attr("y", 0)
            .attr("dy", -3)
            .attr("text-anchor", "middle")
            .text(String);
};*/
</script>

</body>
</html>
